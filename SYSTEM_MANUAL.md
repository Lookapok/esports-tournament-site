# é›»ç«¶éŒ¦æ¨™è³½ç®¡ç†ç³»çµ± - å·¥ä½œèªªæ˜æ–‡ä»¶

**ç³»çµ±ç‰ˆæœ¬**: 1.2.0  
**æœ€å¾Œæ›´æ–°**: 2025å¹´9æœˆ26æ—¥  
**é–‹ç™¼æ¡†æ¶**: Django 5.2.5 + Django REST Framework  
**è³‡æ–™åº«**: SQLite  
**å‰ç«¯**: Bootstrap 5 + HTML/CSS/JavaScript  

---

## ğŸ“‹ ç³»çµ±æ¦‚è¿°

æœ¬ç³»çµ±æ˜¯ä¸€å€‹åŠŸèƒ½å®Œæ•´çš„é›»ç«¶éŒ¦æ¨™è³½ç®¡ç†å¹³å°ï¼Œæ”¯æ´å››ç¨®è³½åˆ¶æ ¼å¼ï¼Œå…·å‚™ Discord Bot æ•´åˆåŠŸèƒ½ä»¥åŠå®Œæ•´çš„æ—¥èªŒç›£æ§ç³»çµ±ã€‚é©ç”¨æ–¼é›»ç«¶è³½äº‹ä¸»è¾¦æ–¹é€²è¡Œè³½äº‹ç®¡ç†ã€æ•¸æ“šçµ±è¨ˆå’Œå³æ™‚ç›£æ§ã€‚

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### æ ¸å¿ƒæ¨¡çµ„

```
esports_project/
â”œâ”€â”€ esports_site/          # ä¸»è¦ Django å°ˆæ¡ˆè¨­å®š
â”‚   â”œâ”€â”€ settings.py        # ç³»çµ±é…ç½®ï¼ˆå«æ—¥èªŒè¨­å®šï¼‰
â”‚   â”œâ”€â”€ urls.py           # ä¸»è¦è·¯ç”±é…ç½®
â”‚   â””â”€â”€ wsgi.py           # éƒ¨ç½²é…ç½®
â”œâ”€â”€ tournaments/          # éŒ¦æ¨™è³½æ ¸å¿ƒæ¨¡çµ„
â”‚   â”œâ”€â”€ models.py         # è³‡æ–™æ¨¡å‹
â”‚   â”œâ”€â”€ views.py          # å‰ç«¯è¦–åœ–
â”‚   â”œâ”€â”€ admin.py          # ç®¡ç†ä»‹é¢
â”‚   â”œâ”€â”€ api_views.py      # API ç«¯é»
â”‚   â”œâ”€â”€ logic.py          # è³½åˆ¶ç®—æ³•
â”‚   â”œâ”€â”€ urls.py           # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ templates/        # å‰ç«¯æ¨¡æ¿
â”œâ”€â”€ monitoring/           # ç›£æ§ç³»çµ±æ¨¡çµ„
â”‚   â”œâ”€â”€ middleware.py     # ç›£æ§ä¸­ä»‹è»Ÿé«”
â”‚   â”œâ”€â”€ admin.py          # ç›£æ§å„€è¡¨æ¿
â”‚   â””â”€â”€ urls.py           # ç›£æ§è·¯ç”±
â”œâ”€â”€ logs/                 # æ—¥èªŒæª”æ¡ˆç›®éŒ„
â”œâ”€â”€ media/                # åª’é«”æª”æ¡ˆï¼ˆéšŠä¼ Logo ç­‰ï¼‰
â””â”€â”€ db.sqlite3            # SQLite è³‡æ–™åº«
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. éŒ¦æ¨™è³½ç®¡ç†

#### 1.1 æ”¯æ´è³½åˆ¶
- **åˆ†çµ„å¾ªç’°è³½** (`round_robin`): åˆ†çµ„å…§æ¯éšŠäº’æ‰“ï¼Œç©åˆ†æ’å
- **ç‘å£«è¼ª** (`swiss`): ä¾æ“šç©åˆ†é…å°ï¼Œé©åˆå¤§å‹è³½äº‹
- **å–®æ·˜æ±°** (`single_elimination`): æ•—è€…æ·˜æ±°ï¼Œå‹è€…æ™‰ç´š
- **é›™æ·˜æ±°** (`double_elimination`): å‹éƒ¨æ•—éƒ¨åˆ¶ï¼Œçµ¦äºˆå…©æ¬¡æ©Ÿæœƒ

#### 1.2 è³½ç¨‹ç®¡ç†
- **è‡ªå‹•è³½ç¨‹ç”Ÿæˆ**: æ”¯æ´æ‰€æœ‰å››ç¨®è³½åˆ¶çš„è‡ªå‹•æ’ç¨‹
- **æ‰‹å‹•è³½ç¨‹èª¿æ•´**: ç®¡ç†å“¡å¯é€é Django Admin èª¿æ•´
- **å³æ™‚è³½æ³æ›´æ–°**: é€é Discord Bot API è‡ªå‹•æ›´æ–°æ¯”è³½çµæœ
- **å°æˆ°æ¨¹é¡¯ç¤º**: è¦–è¦ºåŒ–å°æˆ°bracketï¼Œæ”¯æ´æ‘ºç–Šé¡¯ç¤º

#### 1.3 ç©åˆ†ç³»çµ±
- å‹åˆ© +3 åˆ†ï¼Œå¹³å±€ +1 åˆ†ï¼Œæ•—åŒ— +0 åˆ†
- è‡ªå‹•ç©åˆ†æ¦œæ›´æ–°å’Œæ’åè¨ˆç®—
- æ”¯æ´åˆ†çµ„ç©åˆ†å’Œç¸½ç©åˆ†çµ±è¨ˆ

### 2. Discord Bot æ•´åˆ

#### 2.1 API ç«¯é»
```
POST /api/matches/{match_id}/stats/
```

#### 2.2 æ”¯æ´åŠŸèƒ½
- è‡ªå‹•æ¯”è³½çµæœå ±å‘Š
- é¸æ‰‹æ•¸æ“šçµ±è¨ˆ (æ“Šæ®º/æ­»äº¡/åŠ©æ”»/ACS)
- åœ°åœ–å‹è² è¨˜éŒ„
- éŒ¯èª¤è™•ç†å’Œè³‡æ–™é©—è­‰

#### 2.3 è³‡æ–™æ ¼å¼ç¯„ä¾‹
```json
{
  "map_number": 1,
  "map_name": "Dust2",
  "final_score": "16-14",
  "winning_team_name": "Team Alpha",
  "player_stats": [
    {
      "nickname": "Player1",
      "kills": 25,
      "deaths": 18,
      "assists": 8,
      "first_kills": 3,
      "acs": 245.5
    }
  ]
}
```

### 3. æ•¸æ“šçµ±è¨ˆèˆ‡åˆ†æ

#### 3.1 é¸æ‰‹çµ±è¨ˆ
- å€‹äºº KDA çµ±è¨ˆ
- ACS (Average Combat Score) è©•åˆ†
- é¦–æ®ºæ¬¡æ•¸çµ±è¨ˆ
- è·¨è³½äº‹æ•¸æ“šèšåˆ

#### 3.2 éšŠä¼çµ±è¨ˆ  
- éšŠä¼å‹ç‡çµ±è¨ˆ
- åœ°åœ–å‹è² è¨˜éŒ„
- ç©åˆ†è®ŠåŒ–è¶¨å‹¢

#### 3.3 è³½äº‹çµ±è¨ˆ
- è³½äº‹é€²åº¦è¿½è¹¤
- åƒè³½éšŠä¼ç®¡ç†
- æ¯”è³½çµæœæ­·å²

### 4. æ—¥èªŒç›£æ§ç³»çµ± ğŸ†•

#### 4.1 æ—¥èªŒåˆ†é¡
- **API æ—¥èªŒ** (`logs/api.log`): Discord Bot API å‘¼å«è¨˜éŒ„
- **æ¥­å‹™æ—¥èªŒ** (`logs/business.log`): è³½ç¨‹ç”Ÿæˆã€ç®¡ç†æ“ä½œ
- **ç³»çµ±æ—¥èªŒ** (`logs/django.log`): Django ç³»çµ±é‹è¡Œæ—¥èªŒ
- **éŒ¯èª¤æ—¥èªŒ** (`logs/error.log`): ç³»çµ±éŒ¯èª¤å’Œä¾‹å¤–

#### 4.2 ç›£æ§å„€è¡¨æ¿
- **å³æ™‚çµ±è¨ˆ**: è«‹æ±‚æ•¸ã€æˆåŠŸç‡ã€éŒ¯èª¤ç‡ã€å¹³å‡å›æ‡‰æ™‚é–“
- **è¦–è¦ºåŒ–åœ–è¡¨**: HTTP ç‹€æ…‹ç¢¼åˆ†å¸ƒã€è«‹æ±‚æ–¹æ³•çµ±è¨ˆ
- **éŒ¯èª¤è¿½è¹¤**: æœ€è¿‘éŒ¯èª¤è©³ç´°åˆ—è¡¨å’Œæ™‚é–“è»¸
- **è‡ªå‹•æ›´æ–°**: æ¯30ç§’è‡ªå‹•é‡æ–°æ•´ç†æ•¸æ“š

#### 4.3 æ—¥èªŒæ ¼å¼
```json
{
  "levelname": "INFO",
  "asctime": "2025-09-26 11:44:10,661",
  "module": "api_views",
  "message": "Game Report Completed Successfully",
  "event_type": "game_report_success",
  "match_id": 123,
  "stats_created": 10
}
```

---

## ğŸ® ä½¿ç”¨èªªæ˜

### ç®¡ç†å“¡æ“ä½œ

#### 1. å»ºç«‹éŒ¦æ¨™è³½
```
1. é€²å…¥ Django Admin (/admin/)
2. é¸æ“‡ "éŒ¦æ¨™è³½" â†’ "æ–°å¢éŒ¦æ¨™è³½"
3. å¡«å¯«è³½äº‹è³‡è¨Šï¼šåç¨±ã€éŠæˆ²ã€è³½åˆ¶ã€è¦å‰‡ç­‰
4. å„²å­˜å¾Œæ·»åŠ åƒè³½éšŠä¼
```

#### 2. è³½ç¨‹ç”Ÿæˆ
```
æ–¹å¼ä¸€ï¼šé€é Admin æ‰¹æ¬¡æ“ä½œ
1. é¸æ“‡éŒ¦æ¨™è³½
2. åŸ·è¡Œ "ç‚ºé¸å®šçš„è³½äº‹è‡ªå‹•ç”¢ç”Ÿè³½ç¨‹"

æ–¹å¼äºŒï¼šé€éå‰ç«¯ç•Œé¢
1. é€²å…¥éŒ¦æ¨™è³½è©³æƒ…é 
2. é»æ“Š "ç”¢ç”Ÿè³½ç¨‹" æŒ‰éˆ•
```

#### 3. ç›£æ§ç³»çµ±æŸ¥çœ‹
```
1. è¨ªå• /admin/monitoring/
2. æŸ¥çœ‹å³æ™‚çµ±è¨ˆæ•¸æ“š
3. ç›£æ§ç³»çµ±å¥åº·ç‹€æ³
4. åˆ†æéŒ¯èª¤æ—¥èªŒ
```

### Discord Bot æ“ä½œ

#### 1. å ±å‘Šæ¯”è³½çµæœ
```python
# å‘ API ç™¼é€ POST è«‹æ±‚
url = f"http://your-domain.com/api/matches/{match_id}/stats/"
headers = {"Content-Type": "application/json"}
data = {
    "map_number": 1,
    "map_name": "Ascent",
    "final_score": "13-11",
    "winning_team_name": "Team Alpha",
    "player_stats": [...]
}
response = requests.post(url, json=data, headers=headers)
```

#### 2. æŸ¥è©¢éŒ¦æ¨™è³½è³‡è¨Š
```python
# å–å¾—éŒ¦æ¨™è³½åˆ—è¡¨
response = requests.get("http://your-domain.com/api/tournaments/")

# å–å¾—ç‰¹å®šæ¯”è³½è³‡è¨Š
response = requests.get(f"http://your-domain.com/api/matches/{match_id}/")
```

---

## ğŸ› ï¸ æŠ€è¡“è¦æ ¼

### ç³»çµ±éœ€æ±‚
- **Python**: 3.8+
- **Django**: 5.2.5
- **è³‡æ–™åº«**: SQLite (å¯æ“´å±•è‡³ PostgreSQL/MySQL)
- **è¨˜æ†¶é«”**: æœ€å°‘ 1GB RAM
- **å„²å­˜ç©ºé–“**: æœ€å°‘ 5GB

### ç›¸ä¾å¥—ä»¶
```
Django==5.2.5
djangorestframework==3.15.2
django-tables2==2.7.0
python-json-logger==2.0.7
```

### ç’°å¢ƒè®Šæ•¸
```
DEBUG=True                    # é–‹ç™¼æ¨¡å¼
SECRET_KEY=your-secret-key    # Django å¯†é‘°
ALLOWED_HOSTS=localhost,127.0.0.1
```

---

## ğŸ”§ éƒ¨ç½²èªªæ˜

### é–‹ç™¼ç’°å¢ƒå•Ÿå‹•
```bash
# 1. å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
.\venv\Scripts\activate

# 2. å®‰è£ç›¸ä¾å¥—ä»¶  
pip install -r requirements.txt

# 3. åŸ·è¡Œè³‡æ–™åº«é·ç§»
python manage.py migrate

# 4. å‰µå»ºç®¡ç†å“¡å¸³è™Ÿ
python manage.py createsuperuser

# 5. å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
python manage.py runserver
```

### ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²
```bash
# 1. è¨­å®šç’°å¢ƒè®Šæ•¸
export DEBUG=False
export SECRET_KEY=your-production-secret-key

# 2. æ”¶é›†éœæ…‹æª”æ¡ˆ
python manage.py collectstatic

# 3. ä½¿ç”¨ Gunicorn å•Ÿå‹•
gunicorn esports_site.wsgi:application --bind 0.0.0.0:8000
```

---

## ğŸ“Š è³‡æ–™æ¨¡å‹

### æ ¸å¿ƒå¯¦é«”
- **Tournament**: éŒ¦æ¨™è³½ä¸»è¡¨
- **Team**: åƒè³½éšŠä¼
- **Player**: é¸æ‰‹è³‡è¨Š  
- **Match**: æ¯”è³½å ´æ¬¡
- **Game**: å–®å±€éŠæˆ²
- **PlayerGameStat**: é¸æ‰‹å–®å±€çµ±è¨ˆ
- **Standing**: ç©åˆ†æ¦œ
- **Group**: åˆ†çµ„è³‡è¨Š

### é—œè¯é—œä¿‚
```
Tournament (1) â†â†’ (N) Team (participants)
Tournament (1) â†â†’ (N) Match  
Tournament (1) â†â†’ (N) Group
Team (1) â†â†’ (N) Player
Match (1) â†â†’ (N) Game
Game (1) â†â†’ (N) PlayerGameStat
```

---

## ğŸš€ ç³»çµ±æ•ˆèƒ½

### å›æ‡‰æ™‚é–“
- **API è«‹æ±‚**: < 1ms (å¹³å‡)
- **é é¢è¼‰å…¥**: < 100ms
- **è³½ç¨‹ç”Ÿæˆ**: < 5ç§’ (64éšŠä¼å–®æ·˜æ±°)

### ä¸¦ç™¼è™•ç†
- **æ”¯æ´ä¸¦ç™¼**: 100+ åŒæ™‚ä½¿ç”¨è€…
- **API é™æµ**: å¯é…ç½®é™æµæ©Ÿåˆ¶
- **è³‡æ–™åº«é€£æ¥**: é€£æ¥æ± ç®¡ç†

### ç›£æ§æŒ‡æ¨™
- **ç³»çµ±å¯ç”¨æ€§**: 99.9%+
- **éŒ¯èª¤ç‡**: < 0.1%
- **æ—¥èªŒä¿ç•™**: 30å¤©è‡ªå‹•è¼ªè½‰

---

## ğŸ” å®‰å…¨æ€§

### èªè­‰æˆæ¬Š
- Django å…§å»ºä½¿ç”¨è€…ç³»çµ±
- Session åŸºç¤èªè­‰
- API å¯æ“´å±• Token èªè­‰

### è³‡æ–™ä¿è­·
- CSRF ä¿è­·å•Ÿç”¨
- SQL æ³¨å…¥é˜²è­·
- XSS é˜²è­·æ©Ÿåˆ¶

### æ—¥èªŒå®‰å…¨
- æ•æ„Ÿè³‡æ–™é®ç½©
- å­˜å–æ—¥èªŒè¨˜éŒ„
- å®šæœŸæ—¥èªŒè¼ªè½‰

---

## ğŸ“ˆ æœªä¾†è¦åŠƒ

### éšæ®µäºŒè¨ˆç•«
- ç³»çµ±è³‡æºç›£æ§ (CPUã€è¨˜æ†¶é«”)
- å‘Šè­¦ç³»çµ± (Emailã€Slack é€šçŸ¥)
- é€²éšæ•¸æ“šåˆ†æ

### éšæ®µä¸‰è¨ˆç•«  
- å¤–éƒ¨ç›£æ§å·¥å…·æ•´åˆ (Grafana)
- é æ¸¬æ€§åˆ†æ
- è‡ªå‹•åŒ–æ•ˆèƒ½èª¿å„ª

### åŠŸèƒ½æ“´å±•
- å¤šèªè¨€æ”¯æ´
- è¡Œå‹•è£ç½® APP
- å³æ™‚ç›´æ’­æ•´åˆ

---

## ğŸ“ æŠ€è¡“æ”¯æ´

### å¸¸è¦‹å•é¡Œ
1. **è³½ç¨‹ç„¡æ³•ç”Ÿæˆ**: æª¢æŸ¥æ˜¯å¦å·²æ·»åŠ åƒè³½éšŠä¼
2. **API å›å‚³ 401**: ç¢ºèªèªè­‰é…ç½®æ˜¯å¦æ­£ç¢º
3. **æ—¥èªŒæª”æ¡ˆéå¤§**: æª¢æŸ¥è¼ªè½‰æ©Ÿåˆ¶æ˜¯å¦æ­£å¸¸é‹ä½œ

### æ—¥èªŒæŸ¥çœ‹
```bash
# æŸ¥çœ‹ API æ—¥èªŒ
tail -f logs/api.log

# æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
tail -f logs/error.log

# æœå°‹ç‰¹å®šéŒ¯èª¤
grep "ERROR" logs/*.log
```

### åµéŒ¯å·¥å…·
- Django Debug Toolbar (é–‹ç™¼ç’°å¢ƒ)
- ç›£æ§å„€è¡¨æ¿ (/admin/monitoring/)
- Django Admin æ—¥èªŒæŸ¥çœ‹

---

## ğŸ“ ç‰ˆæœ¬æ­·å²

### v1.2.0 (2025-09-26)
- âœ¨ æ–°å¢å®Œæ•´æ—¥èªŒç›£æ§ç³»çµ±
- âœ¨ æ–°å¢ç›£æ§å„€è¡¨æ¿
- ğŸ”§ æ”¹å–„ UI æ‘ºç–Šé¡¯ç¤º
- ğŸ› ä¿®å¾©ç¾¤çµ„è³‡æ–™ä¸€è‡´æ€§å•é¡Œ

### v1.1.0 (2025-09-25)  
- âœ¨ æ–°å¢å–®æ·˜æ±°ã€é›™æ·˜æ±°è³½åˆ¶
- ğŸ”§ æ”¹å–„è³½ç¨‹ç”Ÿæˆç®—æ³•
- ğŸ“ å®Œå–„ API æ–‡ä»¶

### v1.0.0 (2025-08-18)
- ğŸ‰ åˆå§‹ç‰ˆæœ¬ç™¼å¸ƒ
- âœ¨ åŸºæœ¬éŒ¦æ¨™è³½ç®¡ç†åŠŸèƒ½
- âœ¨ Discord Bot API æ•´åˆ
- âœ¨ åˆ†çµ„å¾ªç’°ã€ç‘å£«è¼ªè³½åˆ¶

---

**ç³»çµ±ç‹€æ…‹**: ğŸŸ¢ ç”Ÿç”¢å°±ç·’  
**ç¶­è­·æ¨¡å¼**: ğŸ”„ æŒçºŒæ›´æ–°  
**æŠ€è¡“æ”¯æ´**: ğŸ“§ è¯çµ¡é–‹ç™¼åœ˜éšŠ
